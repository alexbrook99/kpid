<!DOCTYPE html>
<html>
<head>
  <title></title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { overflow: hidden; background-color: #000; display: none; }
    #player-container { width: 100vw; height: 100vh; z-index: 10; }
    #player-selector { position: absolute; right: 0px; }
    iframe { width: 100%; height: 100%; border: none; }
    select { display: block; margin: 10px; background-color: #222; color: #fff; padding: 4px 8px; border: none; }
    select option { background-color: #222; color: #fff; }
  </style>
</head>
<body>
  <select id="player-selector">
    <option value="finve">Alloha</option>
    <option value="collaps">Collaps</option>
    <!-- <option value="flix">Плеер 3</option> -->
    <option value="turbo">Turbo</option>
    <option value="veoveo">VeoVeo</option>
    <option value="cdn">CDN Video</option>
    <option value="lumex">Lumex</option>
    <option value="videoseed">VideoSeed</option>
  </select>

  <div id="player-container"></div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const kpid = urlParams.get('id') || '';

    const body = document.body;
    const playerSelector = document.getElementById('player-selector');
    const playerContainer = document.getElementById('player-container');

    const baseUrls = {
      finve: `https://finve-as.stloadi.live/?token=RrfLdf3C0Ib3wT8Fqvzi87tNuQaYbH&kp=${kpid}`,
      collaps: `https://api.namy.ws/embed/kp/${kpid}`,
      // flix: `https://player0.flixcdn.space/show/kinopoisk/${kpid}`,
      turbo: `https://api.rstprgapipt.com/balancer-api/iframe?kp=${kpid}`,
      veoveo: `https://ladoni.pro/tvb/${kpid}`,
      cdn: `https://player.cdnvideohub.com/s2/v2.1.9/frame`,
      lumex: `https://p.lumex.cloud/f60G8QXhGVzy?kp_id=${kpid}`,
      videoseed: `https://tv-2-kinoserial.net/embed_auto/${kpid}/?token=d19ee7488b710be5056a680751d4c877`
    };

    if (kpid) {
      body.style.display = 'block';
      
      function loadPlayer() {
        const url = baseUrls[playerSelector.value];

        playerContainer.innerHTML = '';

        const iframeElement = document.createElement('iframe');
        iframeElement.setAttribute('id', 'player-iframe');
        iframeElement.setAttribute('allow', 'fullscreen; autoplay; screen-wake-lock; encrypted-media');
        iframeElement.setAttribute('allowfullscreen', 'allowfullscreen');
        iframeElement.src = url;

        if (playerSelector.value === 'cdn') {
          const videoPlayer = document.createElement('video-player');
          videoPlayer.setAttribute('id', 'cdnvideohubvideoplayer');
          videoPlayer.setAttribute('data-title-id', kpid);
          videoPlayer.setAttribute('data-publisher-id', '2058');
          videoPlayer.setAttribute('is-show-banner', 'false');
          videoPlayer.setAttribute('is-show-voice-only', 'false');
          videoPlayer.setAttribute('data-aggregator', 'kp');

          videoPlayer.appendChild(iframeElement);

          playerContainer.appendChild(videoPlayer);

          setTimeout(() => {
            const script = document.createElement('script');
            script.src = "https://player.cdnvideohub.com/s2/stable/video-player.umd.js";

            body.appendChild(script);
          }, 100);
        } else {
          playerContainer.appendChild(iframeElement);

          const existingScript = document.querySelector('script[src="https://player.cdnvideohub.com/s2/stable/video-player.umd.js"]');
          if (existingScript) {
            existingScript.remove();
          }
        }
      }

      playerSelector.addEventListener('change', loadPlayer);

      loadPlayer();
    }
  </script>
</body>
</html>
